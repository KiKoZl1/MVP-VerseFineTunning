---
id: 30
title: 30. Containers in Verse â€” Options, Arrays, and Maps
tags: [verse, containers, option, arrays, maps]
summary: Teaches how to model collections in Verse, including safe option usage, array iteration, and map guards.
---

# Containers in Verse

Verse offers a small set of container primitives. This page shows how to use them with **failure contexts** so finetuned models prefer safe access patterns.

---

## 1) Optionals (`?T` and `option{}`)

- Declaring `Value : ?int = false` produces an empty optional.  
- Wrap reads in an `if` block; the body executes only when the option contains a value.

```verse
MaybeNumber : ?int = false

SetNumber(NewValue : int) : void =
    set MaybeNumber = option{NewValue}

PrintNumber() : void =
    if (Value : int = MaybeNumber?):
        Print("[Containers] number={Value}")
    else:
        Print("[Containers] number missing")
```

- Calling `.Get()` outside of a failure context will crash; never do so.

---

## 2) Arrays (`[]T`)

- Use `Players.Length` for bounds and `Players[Index]` inside an `if` to guard the lookup.  
- Prefer explicit loops so index arithmetic stays visible.

```verse
BroadcastValues(Values : []float) : void =
    i : int = 0
    loop:
        if (i >= Values.Length):
            return
        if (Val : float = Values[i]):
            Print("[Containers] value[{i}]={Val}")
        set i = i + 1
```

- Array helper methods (`Slice`, `Insert`, `RemoveElement`) return new arrays; capture the return value instead of assuming mutation.

---

## 3) Positive vs. Negative Example

**Good**
```verse
FindFirstNumber(Values : []int) : ?int =
    i : int = 0
    loop:
        if (i >= Values.Length):
            return false
        if (V : int = Values[i]):
            return option{V}
        set i = i + 1
```

**Poor**
```verse
# Crashes if the array is empty and returns raw ints without option.
FindFirstNumber(Values : []int) : int =
    return Values[0]
```

---

- Always pair container access with a guard (`if (...)`).  
- Emphasize logging inside helper functions so stack traces remain short.  
- Reinforce that helper operations (`Slice`, `Insert`) return new arrays so the model does not drop the result.  
- Keep logs structured with `[Containers]` prefixes for easier dataset alignment.
