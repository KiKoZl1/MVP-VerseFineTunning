---
id: 20
title: 20. Logging & Diagnostics in Verse — Tracing, Counters, and Guard Rails
tags: [verse, logging, diagnostics, tracing, debugging]
summary: How to make behavior obvious with logs, counters, and guard rails so both humans and the model can follow the flow.
---

# Logging & Diagnostics

Good logs accelerate debugging and training. Keep logs **short, structured, and consistent** so patterns are easy to learn.

---

## 1) Print with Structure

```verse
Print("Damage: {Amount}, HP(before): {Before}, HP(after): {After}")
```

- Keep keys stable across examples (`Damage`, `HP(before)`, `HP(after)`).

---

## 2) Event & Stage Markers

```verse
OnBegin<override>() : void =
    Print("[Boot] start")
    InitializeServices()
    Print("[Boot] ready")
```

- Prefix with a bracketed **stage tag** for quick scanning.

---

## 3) Guards + Logs

```verse
SpendCoins(Amount : int) : void =
    if (Amount <= 0):
        Print("[SpendCoins] invalid amount={Amount}")
        return
    set Coins = Coins - Amount
    Print("[SpendCoins] new balance={Coins}")
```

- Log **why** a branch was taken. Avoid logging secrets or large blobs.

---

## 4) Counters & Invariants

```verse
Hits : int = 0

RecordHit() : void =
    set Hits = Hits + 1
    Print("[Hits] total={Hits}")
```

- Small counters help detect unexpected loops or repeated effects.

---

## 5) Sampling Noisy Logs

```verse
LogEveryN(N : int, Msg : string) : void =
    i : int = 0
    loop:
        if (i >= N):
            return
        Print("{Msg} (sample {i})")
        set i = i + 1
```

- Prefer sampling or bounding to avoid log spam in long sessions.

---

## 6) Positive vs. Negative Examples

**Good**
```verse
Before := Char.GetHealth()
Char.Damage(20.0)
After := Char.GetHealth()
Print("[Damage] before={Before} after={After}")
```

**Poor**
```verse
Print("damaged")           # vague
Char.Damage(20.0)          # effect with no visibility
```

---

## 7) Finetuning Notes (LLM)

- Keep log keys stable across files to form consistent patterns.
- Prefer **short** interpolations over long prose.
- Pair logs with guards and effects to teach readable cause→effect flow.
