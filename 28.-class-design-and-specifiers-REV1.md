---
id: 28
title: 28. Class Design & Specifiers in Verse (Revised) â€” Tiny APIs and Composition
tags: [verse, classes, constructors, composition, specifiers, api-surface]
summary: Revised class design guidance with a preference for composition over inheritance, tiny APIs, and explicit invariants in constructors.
---

# Class Design & Specifiers (Revised)

Prefer **composition** over deep inheritance and keep the public API **tiny**. Constructors enforce invariants; methods are short and either **pure** or have **clear effects**.

> Specifiers used here: `<constructor>` for factories, `<override>` for event entry points.

---

## 1) Minimal Data Class + Constructor

```verse
DamageWindow := class:
    Min : float
    Max : float

MakeDamageWindow<constructor>(Min : float, Max : float) := DamageWindow:
    # Ensure Min <= Max
    if (Min > Max):
        Tmp := Min
        set Min = Max
        set Max = Tmp
    return
```

- Enforce invariants at construction time.

---

## 2) Composition: Rule + Strategy

```verse
type DamageStrategy = class:
    Scale : float

MakeDamageStrategy<constructor>(Scale : float) := DamageStrategy:
    return

Apply(self : DamageStrategy, Rule : DamageWindow, Base : float) : float =
    Raw := Base * self.Scale
    # Pure clamp using Rule
    return (Raw < Rule.Min) ? Rule.Min : ((Raw > Rule.Max) ? Rule.Max : Raw)
```

- The **strategy** composes with the **window**; no inheritance required.

---

## 3) Orchestration with `<override>`

```verse
OnBegin<override>() : void =
    Rule := MakeDamageWindow<constructor>(5.0, 25.0)
    Strat := MakeDamageStrategy<constructor>(1.5)
    Amount := Apply(Strat, Rule, 12.0)
    Print("[Damage] amount={Amount}")
```

- Keep events thin; do the work in helpers/methods.

---

## 4) API Surface Review Checklist

- Properties are **unit-aware** (`Seconds`, `Meters`, `Amount`).
- Constructors enforce **invariants** and set sensible defaults.
- Methods are **short**; prefer returning values (pure) when possible.
- Prefer **composition**; use inheritance sparingly for narrow specialization.

---

## 5) Finetuning Notes (LLM)

- Show a constructor with an explicit invariant.
- Pair composition example with a tiny event that logs one value.
- Keep names stable and action-oriented.
